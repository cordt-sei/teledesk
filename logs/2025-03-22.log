[2025-03-22T18:09:23.966Z] [INFO] [bot] Starting bot process
[2025-03-22T18:09:23.967Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:09:24.083Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:09:24.128Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:09:27.675Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:09:52.387Z] [INFO] [slackTester] Starting Slack acknowledgment test...
[2025-03-22T18:09:52.389Z] [INFO] [slackTester] Creating a test message in Slack...
[2025-03-22T18:09:52.738Z] [INFO] [slackTester] Test message created with timestamp: 1742666992.650359
[2025-03-22T18:09:52.738Z] [INFO] [slackTester] Simulating button click by sending webhook...
[2025-03-22T18:09:52.751Z] [ERROR] [slackWebhook] Express error handler caught error
  Error: stream is not readable
  Stack: InternalServerError: stream is not readable
    at readStream (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:185:17)
    at getRawBody (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:116:12)
    at read (/home/cordt/repos/teledesk/node_modules/body-parser/lib/read.js:79:3)
    at urlencodedParser (/home/cordt/repos/teledesk/node_modules/body-parser/lib/types/urlencoded.js:119:5)
    at Layer.handle [as handle_request] (/home/cordt/repos/teledesk/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:328:13)
    at /home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:346:12)
    at next (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:280:10)
    at IncomingMessage.<anonymous> (file:///home/cordt/repos/teledesk/modules/slackWebhook.js:34:9)
[2025-03-22T18:09:56.103Z] [ERROR] [slackWebhook] Express error handler caught error
  Error: stream is not readable
  Stack: InternalServerError: stream is not readable
    at readStream (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:185:17)
    at getRawBody (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:116:12)
    at read (/home/cordt/repos/teledesk/node_modules/body-parser/lib/read.js:79:3)
    at urlencodedParser (/home/cordt/repos/teledesk/node_modules/body-parser/lib/types/urlencoded.js:119:5)
    at Layer.handle [as handle_request] (/home/cordt/repos/teledesk/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:328:13)
    at /home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:346:12)
    at next (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:280:10)
    at IncomingMessage.<anonymous> (file:///home/cordt/repos/teledesk/modules/slackWebhook.js:34:9)
[2025-03-22T18:11:43.373Z] [INFO] [bot] Starting bot process
[2025-03-22T18:11:43.375Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:11:43.442Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:11:43.453Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:11:46.963Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:13:39.258Z] [INFO] [bot] Starting bot process
[2025-03-22T18:13:39.259Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:13:39.317Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:13:39.327Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:13:42.829Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:14:37.689Z] [INFO] [bot] Starting bot process
[2025-03-22T18:14:37.691Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:14:37.738Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:14:37.746Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:14:41.240Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:14:57.888Z] [INFO] [bot] Starting bot process
[2025-03-22T18:14:57.891Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:14:58.044Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:14:58.052Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:15:01.416Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:16:04.641Z] [INFO] [bot] Starting bot process
[2025-03-22T18:16:04.643Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:16:04.737Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:16:04.750Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:16:08.221Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:16:28.835Z] [INFO] [bot] Starting bot process
[2025-03-22T18:16:28.837Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:16:28.880Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:16:28.889Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:16:32.460Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:16:35.710Z] [INFO] [slackDiagnostics] Starting Slack setup diagnostics...
[2025-03-22T18:16:35.711Z] [INFO] [slackDiagnostics] Checking environment variables...
[2025-03-22T18:16:35.712Z] [INFO] [slackDiagnostics] ✅ SLACK_API_TOKEN is properly set
[2025-03-22T18:16:35.712Z] [INFO] [slackDiagnostics] ✅ SLACK_CHANNEL_ID is set
[2025-03-22T18:16:35.712Z] [INFO] [slackDiagnostics] ✅ SLACK_SIGNING_SECRET is set
[2025-03-22T18:16:35.712Z] [INFO] [slackDiagnostics] Checking webhook server at http://basementnodes.ca:3030/slack/interactions...
[2025-03-22T18:16:35.749Z] [INFO] [slackWebhook] Test endpoint hit
[2025-03-22T18:16:35.757Z] [INFO] [slackDiagnostics] ✅ Webhook server test endpoint is responsive (Webhook server is running!)
[2025-03-22T18:16:35.757Z] [INFO] [slackDiagnostics] Testing Slack API access...
[2025-03-22T18:16:35.948Z] [INFO] [slackDiagnostics] ✅ Slack API access confirmed (Team: Sei Foundation, User: telegram_team_forward)
[2025-03-22T18:16:35.948Z] [INFO] [slackDiagnostics] Checking if bot is in channel C08HCKYP6G0...
[2025-03-22T18:16:36.064Z] [INFO] [slackDiagnostics] To complete setup, ensure the following in your Slack App settings:
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] 1. Interactivity is turned ON
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] 2. Request URL is set to http://basementnodes.ca:3030/slack/interactions
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] 3. Bot has the required scopes: chat:write, channels:read, chat:write.public
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] 
===== ISSUES FOUND =====
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] ❌ Channel check failed: missing_scope
[2025-03-22T18:16:36.065Z] [INFO] [slackDiagnostics] 
===== RECOMMENDED ACTIONS =====
[2025-03-22T18:16:56.461Z] [INFO] [slackTester] Starting Slack acknowledgment test...
[2025-03-22T18:16:56.463Z] [INFO] [slackTester] Creating a test message in Slack...
[2025-03-22T18:16:56.781Z] [INFO] [slackTester] Test message created with timestamp: 1742667416.686179
[2025-03-22T18:16:56.781Z] [INFO] [slackTester] Simulating button click by sending webhook...
[2025-03-22T18:16:56.782Z] [DEBUG] [slackTester] Sending webhook request to: http://basementnodes.ca:3030/slack/interactions
[2025-03-22T18:16:56.782Z] [DEBUG] [slackTester] Webhook payload:
  {
  "payloadLength": 1424,
  "timestamp": "1742667416",
  "hasSignature": true
}
[2025-03-22T18:16:56.789Z] [ERROR] [slackWebhook] Express error handler caught error
  Error: stream is not readable
  Stack: InternalServerError: stream is not readable
    at readStream (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:185:17)
    at getRawBody (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:116:12)
    at read (/home/cordt/repos/teledesk/node_modules/body-parser/lib/read.js:79:3)
    at urlencodedParser (/home/cordt/repos/teledesk/node_modules/body-parser/lib/types/urlencoded.js:119:5)
    at Layer.handle [as handle_request] (/home/cordt/repos/teledesk/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:328:13)
    at /home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:346:12)
    at next (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:280:10)
    at IncomingMessage.<anonymous> (file:///home/cordt/repos/teledesk/modules/slackWebhook.js:38:9)
[2025-03-22T18:16:56.791Z] [INFO] [slackTester] Webhook response:
  {
  "status": 500,
  "statusText": "Internal Server Error",
  "data": "Internal Server Error"
}
[2025-03-22T18:16:57.797Z] [INFO] [slackTester] Cleaning up test message...
[2025-03-22T18:16:57.986Z] [INFO] [slackTester] Test message deleted successfully
[2025-03-22T18:16:57.986Z] [INFO] [slackTester] Test completed! Check the server logs to see if acknowledgment was processed correctly.
[2025-03-22T18:16:57.986Z] [INFO] [slackTester] Test complete!
[2025-03-22T18:17:42.150Z] [ERROR] [slackWebhook] Express error handler caught error
  Error: stream is not readable
  Stack: InternalServerError: stream is not readable
    at readStream (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:185:17)
    at getRawBody (/home/cordt/repos/teledesk/node_modules/raw-body/index.js:116:12)
    at read (/home/cordt/repos/teledesk/node_modules/body-parser/lib/read.js:79:3)
    at urlencodedParser (/home/cordt/repos/teledesk/node_modules/body-parser/lib/types/urlencoded.js:119:5)
    at Layer.handle [as handle_request] (/home/cordt/repos/teledesk/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:328:13)
    at /home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:346:12)
    at next (/home/cordt/repos/teledesk/node_modules/express/lib/router/index.js:280:10)
    at IncomingMessage.<anonymous> (file:///home/cordt/repos/teledesk/modules/slackWebhook.js:38:9)
[2025-03-22T18:48:41.478Z] [INFO] [bot] Starting bot process
[2025-03-22T18:48:41.479Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:48:41.532Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:48:41.542Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:48:45.020Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:49:11.231Z] [INFO] [bot] Starting bot process
[2025-03-22T18:49:11.233Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:49:11.311Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:49:11.321Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:49:14.777Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:52:12.292Z] [INFO] [bot] Starting bot process
[2025-03-22T18:52:12.294Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:52:12.339Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:52:12.347Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
[2025-03-22T18:52:15.871Z] [INFO] [bot] Starting bot with custom polling parameters...
[2025-03-22T18:52:16.262Z] [INFO] [bot] Starting bot process
[2025-03-22T18:52:16.265Z] [INFO] [bot] Clearing webhook and pending updates...
[2025-03-22T18:52:16.319Z] [INFO] [slackWebhook] Starting webhook server
[2025-03-22T18:52:16.329Z] [INFO] [slackWebhook] Slack webhook handler listening on port 3030
  {
  "testUrl": "http://localhost:3030/test",
  "interactionsUrl": "http://localhost:3030/slack/interactions"
}
